## 웹 아키텍처
- 클라이언트/서버
  - 웹은 크라이언트/서버 기반 시스템으로, 클라이언트/서버 규약의 핵심 사항은 관심사의 분리다.
- 균일한 인터페이스
  - 웹을 구성하는 클라이언트. 서버, 네트워크 등의 매체 간 인터페이스는 각 인터페이스의 일관성에 기반한다.
  - 웹 컴포넌트들은 다음 네 가지의 인터페이스 제약에 따라 서로 일관성 있게 상호 운영된다.
    - 1) 리소스 식별
      - URI 같은 고유 식별자
    - 2) 표현을 통한 리소스 처리
      - 클라이언트는 리소스 표현을 처리한다. ex) HTML, JSON
    - 3) 자기 서술적 메시지
      - 자기 서술적 메시지는 메타데이터를 포함하는데, 이것은 리소스의 상태, 표현 형식과 크기, 메시지 자신에 대한 추가 정보를 전달할 수 있다.
    - 4) 애플리케이션 상태 엔진으로서의 하이퍼미디어
      - 리소스의 상태 표현은 과련 리소스의 링크를 포함한다.
- 계층 시스템
  - 프락시 또는 게이트웨이 같은 네트워크 기반의 중간매체를 사용할 수 있게 한다.
  - 웹의 일관된 인터페이스를 사용하면 중간매체를 클라이언트와 서버 사이에 마치 없는 것처럼 배치할 수 있다.
- 캐시
  - 캐시는 웹 구조의 중요 제약조건 중 하나다.
- 상태 없음
  - 상태 없음 제약조건은 웹 서버가 크라이언트의 상태를 관리할 필요가 없다는 의미다.
- 주문형 코드
  - 스크립트나 플러그인 같은 실행 가능한 프로그램을 일시적으로 클라에 전송하여 실행할 수 있도록 한다.
  
## REST
- Representational State Transfer (표현 상태 전이)

## URI 식별자 설계
### URI 형태
- URI = scheme "://" authority "/" path["?" query]["#" fragment]
  - 슬래시 구분자(/)는 계층 관계를 나타내는 데 사용한다.
  - URI 마지막 문자로 슬래시(/)를 포함하지 않는다.
    - URI 경로 마지막에 있는 슬래시는 아무런 의미가 없지만 혼란을 초래할 수 있다.
    - URI에 포함되는 모든 글자는 리소스의 유일한 식별자로 작용한다.
      - 서로 다른 URI 두개는 서로 다른 리소스에 매핑된다.
  - 하이픈(-)은 URI 가독성을 높이는데 사용한다.
    - URI를 쉽게 읽고 해석하기 위해, 긴 URI 경로에 하이픈을 사용해서 가독성을 높인다.
  - 밑줄(_)은 URI에 사용하지 않는다.
    - 보기도 어렵기 때문에 밑줄 대신 하이픈을 사용해야 된다.
  - URI 경로에는 소문자가 적합하다.
    - RFC 3986은 URI 스키마와 호스트를 제외하고는 대소문자를 구별하도록 규정한다.
  - 파일 확장자는 URI에 포함시키지 않는다.
    - 확장자는 미디어 타입에 의존하는데 Content-Type 헤더를 통해 전달한다.

### URI 권한 설계
- API에 있어서 서브 도메이은 일관성 있게 사용해야 한다.
- 클라이언트 개발자 포탈 서브 도메인 이름은 일관성 있게 만들어야 한다.

### 리소스 모델링
- URI 경로는 REST API의 리소스 모델을 다루는데, 포워드 슬래시(/)로 경로 구문을 나눈다.
- 리소스 모델리은 API의 주요 개념을 확실하게 잡는 훈련과도 같다.
  - 관계형 데이터베이스 스키마를 정의하기 위한 데이터 모델링이나, 객체 지향 시스템에서의 클래스 모델링과 유사하다.

### 리소스 원형
- 디자인 패턴에서와 같이 REST API 디자인에서 보편적으로 쓰이는 리소스의 구조와 행동을 일관된 방식으로 다룰 수 있다.
  - 리소스 모델로 명확하고 정확하게 클라이언트와 통신하려면 REST API는 리소스 원형 중에서 리소스 하나로만 설계해야 한다.

#### 1) 도큐먼트
- 도큐먼트 리소스는 객체 인스턴스나 데이터베이스 레코드와 유사한 단일 개념이다.
- 도큐먼트의 상태 표현은 값을 가진 필드와 다른 관련 리소스와의 링크 둘 다를 가지게 된다.
  - http://api.soccer.restapi.org/leagues(컬렉션)/seattle(도큐먼트)

#### 2) 컬렉션 (서버에서 관리)
- 컬렉션 리소스는 서버에서 관리하는 디렉터리라는 리소스다.
  - http://api.soccer.restapi.org/leagues(컬렉션)

#### 3) 스토어 (클라이언트 관리)
- 스토어는 클라이언트에서 관리하는 리소스 저장소다.
- 스토어 리소스는 API 클라이언트가 리소스를 넣거나 빼는 것, 지우는 것에 관여한다.
  - PUT /users/1234/favorites(스토어)/alonso

#### 4) 컨트롤러
- 컨트롤러 리소스는 절차적인 개념을 모델화한 것이다. 컨트롤러 리소스는 실행 가능한 함수와 같아서 파라미터와 반환 값이 있다.
- REST API는 CRUD라고 알려진 표준적인 메서드와는 논리적으로 매핑되지 않는 애플리케이션 고유의 행동을 컨트롤러 리소스의 도움을 받아 수행한다.
  - POST /alerts/245743/resend(컨트롤러)

### URI 경로 디자인
- {collection-c} / {sotre-s} / {document-d}
  - 도큐먼트 이름으로는 단수 명사를 사용해야 한다.
  - 컬렉션 이르므로는 복수 명사를 사용해야 한다.
  - 스토어 이름으로는 복수 명사를 사용해야 한다.
  - 컨트롤러 이름으로는 동사나 동사구를 사용해야 한다.
  - 경로 부분 중 변하는 부분은 유일한 값으로 대체한다.
    - http://api.soccer.restapi.org/leagues/{leagueId}/teams/{teamId}/players/{playerId}
  - CRUD 기능을 나타내는 것을 URI에 사용하지 않는다.
    - DELETE /users/1234 (O)
    - GET /deleteUser?id=1234 (X)
    - POST / users/1234/delete (X)
  
### URI Query 디자인
- 쿼리 구성요소는 클라이언트에 검색이나 필터링 같은 추가적인 상호작용 능력을 제공한다.
- 그러나 URI의 다른 구성요소와는 달리, 쿼리 부분은 REST API 클라이언트에 반드시 필요한 것은 아니다. (중요)
  - URI 쿼리 부분으로 컬렉션이나 스토어를 필터링할 수 있다.
    - URI 쿼리는 컬렉션이나 스토어 검색 기준으로 사용하기에 적합하다.
      - GET /users?role=admin
  - URI 쿼리는 컬렉션이나 스토어의 결과를 페이지로 구분하여 나타내는데 사용해야 한다.
    - REST API 클라이언트는 쿼리 구성요소를 사용하여 컬렉션이나 스토어의 결과를 pageSize, pageStartIndex 같은 파라미터 값으로 페이지화한다.
      - GET /users?pageSize=25&pageStartIndex=50 (50페이지부터 최대 75페이지까지만)
    - URI 쿼리로 클라리언트의 페이지나 필터링의 요구사항에 대응할 수 없다면? 컬렉션이나 스토어의 파트너가 될 수 있는 특별한 컨트롤러를 고려해본다.
      - POST /users/search (리퀘스트 바디를 통해 좀 더 복잡한 입력을 받는다.)
      
## HTTP를 이용한 인터랙션 설계  
### HTTP/1.1
- REST API는 요청 메서드, 응답 코드, 메시지 헤더 등 HTTP 버전 1.1의 모든 측면을 수용한다.

### 요청 메서드
- REST API 리소스 모델에서 각 HTTP 메서드는 잘 정의된 고유한 의미가 있다.
  - GET 메서드나 POST 메서드를 사용하여 다른 요청 메서드를 처리해서는 안 된다.
  - GET 메서드는 리소스의 상태 표현을 얻는 데 사용해야 한다.
    - 클라이언트의 GET 요청 메시지는 바디 없이 헤더로만 구성된다.
  - 응답 헤더를 가져올 때는 반드시 HEAD 메서드를 사용해야 한다.
    - GET 메서드와 동일한 응답을 주지만, 바디가 없다.
  - PUT 메서드는 리소스를 삽입하거나 저장된 리소스를 갱신하는데 사용해야 한다.
    - 새로운 리소스를 추가하는데 사용한다.
    - 이미 스토어에 저장된 리소스를 갱신하거나 다른 것으로 대체하는데도 PUT 메서드를 사용한다.
  - PUT 메서드는 변경 가능한 리소스를 갱신하는데 사용해야 한다.
  - POST 메서드는 컬렉션에 새로운 리소스를 만드는 데 사용해야 한다.
  - POST 메서드는 컨트롤러를 실행하는 데 사용해야 한다.
  - DELETE 메서드는 그 부모에서 리소스를 삭제하는 데 사용해야 한다.
    - 컬렉션이나 스토어인 부모에서 리소스를 완전히 제거한다.
    - 리소스를 완전히 지우지 않고 임시 삭제 기능을 제공하거나 상태만을 바꾸는 기능을 제공하려면 DELETE 메서드 대신 POST 메서드를 사용해야 한다.
  - OPTIONS 메서드는 리소스의 사용 가능한 인터랙션을 기술한 메타데이터를 가져오는 데 사용해야 한다.
    - Allow : GET, PUT, DELETE
    
### 응답 상태 코드
- REST API는 HTTP 응답 메시지의 Status-Line 부분을 사용하여 클라이언트가 요청한 결과를 알려준다.
- 1XX(정보) : 전송 프로토콜 수준의 정보 교환
- 2XX(성공) : 클라이언트 요청이 성공적으로 수행됨
  - 200("OK")는 일반적인 요청 성공을 나타내는 데 사용해야 한다.
    - 204 상태 코드와는 달리, 200 응답은 응답 바디가 포함된다.
  - 200("OK")는 응답 바디에 에러를 전송하는 데 사용해서는 안 된다.
  - 201("Created")는 성공적으로 리소스를 생성했을 때 사용해야 한다.
  - 202("Accepted")는 비동기 처리가 성공적으로 시작되었음을 알릴 때 사용해야 한다.
  - 204("No Content")는 응답 바디에 의도적으로 아무것도 포함하지 않을 때 사용한다.
- 3XX(재전송) : 클라이언트는 요청을 완료하기 위해 추가적인 행동을 취해야 함
  - 301("Moved Permanently")는 리소스를 이동시켰을 때 사용한다.
  - 302("Found")는 사용하지 않는다.
  - 303("See Other")은 다른 URI를 참조하라고 알려줄 때 사용한다.
  - 304("Not Modified")는 대역폭을 절약할 때 사용한다.
  - 307("Temporary Redirect")는 클라이언트가 다른 URI로 요청을 다시 보내게 할 때 사용해야 한다.
- 4XX(클라이언트 오류) : 클라이언트의 잘못된 요청
  - 400("Bad Request")는 일반적인 요청 실패에 사용햏야 한다.
  - 401("Unauthorized")는 클라이언트 인증에 문제가 있을 때 사용해야 한다.
  - 403("Forbidden")은 인증 상태에 상관없이 액세스를 금지할 때 사용해야 한다.
  - 404("Not Found")는 요청 URI에 해당 리소스가 없을 때 사용해야 한다.
  - 405("Method Not Allowed")는 HTTP 메서드가 지원되지 않을 때 사용해야 한다.
  - 406("Not Acceptable")은 요청된 리소스 미디어 타입을 제공하지 못할 때 사용해야 한다.
  - 409("Conflict")는 리소스 상태에 위반되는 행위를 했을 때 사용해야 한다.
  - 412("Precondition Failed")는 조건부 연산을 지원할 때 사용한다.
  - 415("Unsupported Medit Type")은 요청의 페이로드에 있는 미디어 타입이 처리되지 못했을 떄 사용해야 한다.
- 5XX(서버 오류) : 서버쪽 오류로 인한 상태 코드
  - 500("Internal Server Error")는 API가 잘못 작동할 때 사용해야 한다.
  
## 메타데이터 디자인
### HTTP 헤더
- Content-Type을 사용해야 한다.
  - Content-Type 헤더는 요청이나 응답 메시지 바디에 있는 데이터 타입을 나타낸다.
- Content-Length를 사용해야 한다.
  - 클라이언트는 이 값을 이용하여 바이트의 크기를 올바로 읽었는지 알 수 있다.
  - HEAD 요청을 사용하여 데이터를 다운 로드하지 않고도 바디가 얼마나 큰지 알 수 있다.
- Last-Modified는 응답에 사용해야 한다.
  - 이 응답 헤더의 값은 타임스탬프로, 리소스의 표현 상태 값이 바뀐 마지막 시간을 나타낸다.
- ETag는 응답에 사용해야 한다.
  - ETag 값은 응답 엔티티에 포함된 표현 상태의 특정 버전을 나타내는 일련의 문자열이다.
- 스토어는 조건부 PUT 요청을 지원해야 한다.
  - 스토어 리소스는 PUT 메서드를 사용하여 리소스를 새로 추가하거나 갱신할 수 있다.
- Location은 새로운 리소스의 URI를 나타내는 데 사용해야 한다.
- Cache-Control, Expires, Date 응답 헤더는 캐시 사용을 권장하는데 사용해야 한다.
- Cache-Control, Expires, Pragma 응답 헤더는 캐시 사용을 중지하는 데 사용해야 한다.
- 캐시 기능은 사용해야 한다.
- 만기 캐싱 헤더는 200("OK") 응답에 사용해야 한다.
- 만기 캐싱 헤더는 '3XX' 와 '4XX' 응답에 선택적으로 사용될 수 있다.
- 커스텀 HTTP 헤더는 HTTP 메서드의 행동을 바꾸는데 사용해서는 안 된다.

### 미디어 타입
- 요청이나 응답의 메시지 바디 안에 있는 데이터 형태를 식별하기 위해, Content-Type 헤더 값을 미디어 타입이라고 한다.
- 미디어 타입 종류
  - text/plain : 평문 포맷
  - text/html : HTML로 포맷된 콘텐츠
  - image/jpeg : 표준화한 이미지 압축 방법
  - application/xml : XML로 구조화된 콘텐츠
  - application/atom_xml : feed로 알려진 구조적인 데이터를 XML 기반의 리스트로 포맷팅한 Atom을 사용하는 콘텐츠
  - application/javascript : 자바스크립트 프로그래밍 언어로 작성된 소스 코드
  - application/json : JSON 포맷
  

    
